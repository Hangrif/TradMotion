<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script>

	var ladata;
	var ws;
	var focusListener;
	var blurListener;
	
	// Create the socket with event handlers
function init() {
  // Create and open the socket
  ws = new WebSocket("ws://localhost:6437/v6.json");//use latest
	console.log("did it");
  // On successful connection
  ws.onopen = function(event) {
    var enableMessage = JSON.stringify({enableGestures: true});
    ws.send(enableMessage); // Enable gestures
    ws.send(JSON.stringify({focused: true})); // claim focus
    
    focusListener = window.addEventListener('focus', function(e) {
        ws.send(JSON.stringify({focused: true})); // claim focus
     });

    blurListener = window.addEventListener('blur', function(e) {
         ws.send(JSON.stringify({focused: false})); // relinquish focus
     });
     
    document.getElementById("main").style.visibility = "visible";
    document.getElementById("connection").innerHTML = "WebSocket connection open!";
  };

  // On message received
  ws.onmessage = function(event) {
      ladata = JSON.stringify(JSON.parse(event.data), undefined, 2);
  };

  // On socket close
  ws.onclose = function(event) {
    ws = null;
    window.removeListener("focus", focusListener);
    window.removeListener("blur", blurListener);
    document.getElementById("main").style.visibility = "hidden";
    document.getElementById("connection").innerHTML = "WebSocket connection closed";
  }

  // On socket error
  ws.onerror = function(event) {
    alert("Received error");
  };
}
    
</script>
